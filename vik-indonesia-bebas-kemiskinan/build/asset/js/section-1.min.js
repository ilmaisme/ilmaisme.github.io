gsap.registerPlugin(ScrollTrigger),ScrollTrigger.config({ignoreMobileResize:!0,pinType:"fixed"});let vhLocked=!1;function updateViewportVars(e=!1){if(vhLocked&&!e)return;const t=window.visualViewport?window.visualViewport.height:window.innerHeight;document.documentElement.style.setProperty("--vh",.01*t+"px"),document.documentElement.style.setProperty("--app-height",`${t}px`)}function lockVh(){const e=getComputedStyle(document.documentElement).getPropertyValue("--vh").trim();e&&(document.documentElement.style.setProperty("--vh",e),vhLocked=!0)}function unlockVh(){vhLocked=!1}function getViewportWidth(){return window.visualViewport?window.visualViewport.width:window.innerWidth}function debounce(e,t=120){let o;return(...i)=>{clearTimeout(o),o=setTimeout((()=>e(...i)),t)}}function isMobileDevice(){return/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)}function waitForSectionImages(){return new Promise((e=>{const t=Array.from(document.querySelectorAll(".section1 img"));if(!t.length)return void requestAnimationFrame((()=>requestAnimationFrame(e)));t.forEach((e=>{try{"lazy"===e.loading&&(e.loading="eager")}catch(e){}}));let o=0;const i=()=>{o++,o===t.length&&requestAnimationFrame((()=>requestAnimationFrame(e)))};t.forEach((e=>{e.complete&&(e.naturalWidth||e.naturalHeight)?i():(e.addEventListener("load",i,{once:!0}),e.addEventListener("error",i,{once:!0}))}))}))}function getNaturalHeight(e){if("none"!==getComputedStyle(e).display){const t=e.style.height;e.style.height="auto";const o=e.offsetHeight;return e.style.height=t,o}const t={display:e.style.display,position:e.style.position,visibility:e.style.visibility};e.style.display="block",e.style.position="absolute",e.style.visibility="hidden";const o=e.offsetHeight;return e.style.display=t.display,e.style.position=t.position,e.style.visibility=t.visibility,o}function matchScrollContentHeight(){const e=[...document.querySelectorAll(".section1ScrollContent")];if(!e.length)return;e.forEach((e=>e.style.height="auto"));const t=Math.max(...e.map((e=>getNaturalHeight(e))));e.forEach((e=>e.style.height=`${t}px`))}updateViewportVars();let horizontalTween=null,fixedScrollWidth=null;function killPreviousGSAP(){if(horizontalTween){try{horizontalTween.scrollTrigger?.kill(),horizontalTween.kill()}catch(e){}horizontalTween=null}try{ScrollTrigger.getAll().forEach((e=>e.kill()))}catch(e){}try{gsap.killTweensOf(".section1Scroll")}catch(e){}}function initHorizontalScroll(){const e=document.querySelector(".section1Scroll"),t=document.querySelector(".scroll-area"),o=document.querySelectorAll(".section1ScrollBox");if(!e||!t||o.length<=1)return;const i=e.scrollWidth,r=getViewportWidth(),n=Math.max(0,i-r);fixedScrollWidth=n,horizontalTween=gsap.to(e,{x:()=>-fixedScrollWidth,ease:"none",scrollTrigger:{trigger:t,start:"top top",end:"+="+fixedScrollWidth,scrub:!0,pin:!0,pinSpacing:!0,anticipatePin:0,invalidateOnRefresh:!1,pinType:"fixed",markers:!1}})}function initScrollContentReveal(){if(!horizontalTween)return;const e=gsap.utils.toArray(".section1ScrollContent img");e.forEach(((t,o)=>{const i=e.length,r=o/i,n=(o+.8)/i;gsap.fromTo(t,{opacity:0,y:50},{opacity:1,y:0,ease:"power2.out",scrollTrigger:{trigger:t,containerAnimation:horizontalTween,start:`${r} bottom`,end:`${n} center`,scrub:!0}})}))}function adjustLastBoxPadding(){const e=document.querySelector(".section1ScrollContainer"),t=document.querySelector(".section1ScrollBox5");if(!e||!t)return;const o=e.offsetWidth;let i=window.innerWidth-o;i=2*Math.max(0,i),i+=window.innerWidth>=768?56:16,t.style.paddingRight=`${i}px`}function revealSequential(e,t=null){gsap.utils.toArray(e).forEach(((e,o)=>{gsap.fromTo(e,{scale:.8,opacity:0,y:40},{scale:1,opacity:1,y:0,ease:"power2.out",scrollTrigger:{trigger:t||e,start:t?"top 80%+="+80*o:`top+=${120*o} 80%`,end:t?"top 50%+="+80*o:`top+=${120*o} 55%`,scrub:!0}})}))}function scrubReveal(e,{origin:t="bottom",distance:o=100,opacity:i=0,scrollTrigger:r={}}={}){let n={x:0,y:0};"left"===t&&(n.x=-o),"right"===t&&(n.x=o),"top"===t&&(n.y=-o),"bottom"===t&&(n.y=o);const l={trigger:e,start:"top 90%",end:"top 40%",scrub:!0,markers:!1};gsap.fromTo(e,{x:n.x,y:n.y,opacity:i},{x:0,y:0,opacity:1,ease:"power2.out",scrollTrigger:{...l,...r}})}function handleViewportChangeImmediate(){killPreviousGSAP(),console.log("âš™ï¸ FULL REBUILDâ€¦"),unlockVh(),updateViewportVars(!0),matchScrollContentHeight(),adjustLastBoxPadding(),initHorizontalScroll(),initScrollContentReveal(),gsap.utils.toArray(".section1Caption").forEach((e=>gsap.to(e,{opacity:1,y:0,scale:1,filter:"blur(0px)",duration:.85,ease:"power3.out",delay:.15}))),document.querySelectorAll(".section1Group img, .graph, .section1Arah img, .section1Visi img, .section1EduItem img").forEach((e=>gsap.fromTo(e,{scale:.8,opacity:0},{scale:1,opacity:1,duration:1,ease:"power2.out",scrollTrigger:{trigger:e,start:"top 80%",end:"top 50%",scrub:!0}}))),revealSequential(".needsItem"),revealSequential(".section1StoryImg li"),scrubReveal(".credit__member",{origin:"right",distance:80}),scrubReveal(".credit__team",{origin:"left",distance:80}),ScrollTrigger.refresh(),requestAnimationFrame((()=>{setTimeout((()=>{lockVh(),console.log("ðŸ”’ --vh locked for stable layout")}),60)}))}const handleViewportChange=debounce(handleViewportChangeImmediate,isMobileDevice()?300:120);if(waitForSectionImages().then((()=>{console.log("Images loaded â†’ init GSAP"),handleViewportChangeImmediate()})),window.visualViewport){let e=window.visualViewport.height||window.innerHeight;window.visualViewport.addEventListener("resize",(()=>{const t=window.visualViewport.height||window.innerHeight;updateViewportVars(!1),Math.abs(t-e)>120&&(e=t,handleViewportChange())})),window.visualViewport.addEventListener("scroll",(()=>{updateViewportVars(!1)}))}else window.addEventListener("resize",(()=>{updateViewportVars(!1),handleViewportChange()}));window.addEventListener("orientationchange",(()=>{unlockVh(),updateViewportVars(!0),setTimeout(handleViewportChangeImmediate,260)})),window.addEventListener("load",(()=>{console.log("ðŸ”¥ Window Load â†’ Page stable"),requestAnimationFrame((()=>{ScrollTrigger.refresh(),handleViewportChangeImmediate(),setTimeout((()=>{ScrollTrigger.refresh(),console.log("ðŸ”¥ FINAL REFRESH complete")}),120)}))})),ScrollTrigger.addEventListener("refresh",(()=>{console.group("ðŸ” ScrollTrigger REFRESH"),ScrollTrigger.getAll().forEach((e=>{console.log({trigger:e.trigger,start:e.start,end:e.end,pinSpacerHeight:e.pin&&e.pin.parentNode?e.pin.parentNode.style.height:null})})),console.groupEnd()})),ScrollTrigger.addEventListener("update",(()=>{ScrollTrigger.getAll().forEach((e=>{console.log("UPDATE progress:",e.trigger,e.progress)}))}));