window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;var audio=document.getElementById("audio"),ctx=new AudioContext,analyser=ctx.createAnalyser(),audioSrc=ctx.createMediaElementSource(audio);audioSrc.connect(analyser),analyser.connect(ctx.destination);var start=function(){new Uint8Array(analyser.frequencyBinCount);var t=document.getElementById("canvas"),e=t.width,n=t.height-2,a=[];ctx=t.getContext("2d"),gradient=ctx.createLinearGradient(0,0,0,300),gradient.addColorStop(1,"#0f0"),gradient.addColorStop(.5,"#ff0"),gradient.addColorStop(0,"#f00"),function t(){var o=new Uint8Array(analyser.frequencyBinCount);analyser.getByteFrequencyData(o);var i=Math.round(o.length/(800/12));ctx.clearRect(0,0,e,n);for(var r=0;r<800/12;r++){var u=o[r*i];a.length<Math.round(800/12)&&a.push(u),ctx.fillStyle="#fff",u<a[r]?ctx.fillRect(12*r,n- --a[r],10,2):(ctx.fillRect(12*r,n-u,10,2),a[r]=u),ctx.fillStyle=gradient,ctx.fillRect(12*r,n-u+2,10,n)}requestAnimationFrame(t)}()},trigbutton=document.getElementById("playpause"),myAudio=document.getElementById("audio");trigbutton.onclick=function(){var t="pause!"===trigbutton.value;trigbutton.value=t?"play!":"pause!",myAudio[t?"pause":"play"]()},audio.onplay=function(){start()},audio.onpause=function(){trigbutton.value="play!",trigbutton.checked=!1};