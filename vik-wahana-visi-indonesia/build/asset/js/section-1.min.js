gsap.registerPlugin(ScrollTrigger);let horizontalTween=null,textSwitchTrigger=null,scrollBoxes=[],boxTexts=[];function getViewportWidth(){return window.visualViewport?window.visualViewport.width:window.innerWidth}function getViewportHeight(){return window.visualViewport?window.visualViewport.height:window.innerHeight}function debounce(e,t=120){let i;return function(...o){clearTimeout(i),i=setTimeout((()=>e.apply(this,o)),t)}}const images=Array.from(document.querySelectorAll("img"));let loadedCount=0;function onImageLoaded(){loadedCount++,loadedCount===images.length&&handleViewportChangeImmediate()}function getNaturalHeight(e){if("none"!==window.getComputedStyle(e).display){const t=e.style.height;e.style.height="auto";const i=e.offsetHeight;return e.style.height=t,i}const t={display:e.style.display,position:e.style.position,visibility:e.style.visibility,height:e.style.height,width:e.style.width};e.style.display="block",e.style.position="absolute",e.style.visibility="hidden",e.style.height="auto";const i=e.offsetHeight;return e.style.display=t.display,e.style.position=t.position,e.style.visibility=t.visibility,e.style.height=t.height,e.style.width=t.width,i}function matchScrollContentHeight(){const e=Array.from(document.querySelectorAll(".section1ScrollContent"));if(!e.length)return;e.forEach((e=>e.style.height="auto"));let t=0;e.forEach((e=>{const i=getNaturalHeight(e);i>t&&(t=i)})),t<=0||e.forEach((e=>{e.style.height=`${t}px`}))}function initHorizontalScroll(){if(horizontalTween){try{horizontalTween.scrollTrigger.kill()}catch(e){}try{horizontalTween.kill()}catch(e){}horizontalTween=null}if(scrollBoxes=document.querySelectorAll(".section1ScrollBox"),!scrollBoxes||scrollBoxes.length<=1)return;const e=(scrollBoxes.length-1)*getViewportWidth();horizontalTween=gsap.to(".section1Scroll",{x:()=>-e,ease:"none",scrollTrigger:{trigger:".scroll-area",start:"top top",end:()=>"+="+e,scrub:!0,pin:!0,anticipatePin:1}})}function initTextSwitch(){if(textSwitchTrigger){try{textSwitchTrigger.kill()}catch(e){}textSwitchTrigger=null}boxTexts=Array.from(document.querySelectorAll(".section1BoxTxt")),boxTexts.length&&(boxTexts.forEach(((e,t)=>{0===t?(e.style.display="block",e.classList.add("active")):(e.style.display="none",e.classList.remove("active"))})),textSwitchTrigger=ScrollTrigger.create({trigger:".section1BoxWrap",start:"top center",end:"bottom center",scrub:!0,onUpdate:e=>{const t=Math.max(0,boxTexts.length-1),i=Math.round(e.progress*t),o=Math.min(t,Math.max(0,i));boxTexts.forEach(((e,t)=>{t!==o||e.classList.contains("active")||(boxTexts.forEach((e=>{e.classList.remove("active"),e.style.display="none"})),e.style.display="block",e.classList.add("active"),gsap.fromTo(e,{scale:.9,opacity:0},{scale:1,opacity:1,duration:.6,ease:"power2.out"}))}))}}))}function handleViewportChangeImmediate(){setAppHeight(),matchScrollContentHeight(),initHorizontalScroll(),initTextSwitch(),ScrollTrigger.refresh()}0===images.length?loadedCount=0:images.forEach((e=>{e.complete?onImageLoaded():(e.addEventListener("load",onImageLoaded),e.addEventListener("error",onImageLoaded))}));const handleViewportChange=debounce(handleViewportChangeImmediate,120);window.addEventListener("load",(()=>{handleViewportChangeImmediate()})),window.visualViewport?(window.visualViewport.addEventListener("resize",handleViewportChange),window.visualViewport.addEventListener("scroll",(()=>setAppHeight()))):window.addEventListener("resize",handleViewportChange),window.addEventListener("orientationchange",handleViewportChange),images.length===loadedCount&&handleViewportChangeImmediate(),gsap.utils.toArray(".section1Caption").forEach((e=>{gsap.from(e,{x:-100,opacity:0,duration:1.2,ease:"power3.out",scrollTrigger:{trigger:e,start:"top 85%",toggleActions:"play none none reverse"}})}));